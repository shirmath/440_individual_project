---
title: "Assessing Mental Health Outcomes Across LGB Individuals from Generations Survey"
author: ""
date: "4/14/2022"
output: pdf_document
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      results = FALSE)
```

```{r load-packages}
library(tidyverse)
library(rstanarm)
library(brms)
library(lme4)
library(lattice)
library(patchwork)
library(gtsummary)
library(kableExtra)
library(tidybayes)
library(bookdown)
library(bayesplot)
```

# Abstract

In recent years, there has been an increase of attention into evaluating the health and societal outcomes of lesbian, gay, and bisexual (LGB) individuals in the United States. One such study that was conducted into examining various health and societal outcomes for LGB individuals was the Generations study that was conducted from 2016 through 2019. In this analysis, I utilized the data collected from the Generations study, particular from Wave 1 and Wave 2 of the study, to examine associations between various demographic characteristics of LGB individuals in the US and the difference in mental health outcomes, as measured by the Kessler-6 scale, for these individuals from Wave 1 to Wave 2 of the Generations study. From my analysis, I found that, holding all else constant, LGB individuals from the South were expected to have a greater increase in their Kessler-6 score than LGB individuals from the Northeast.

\newpage

# Introduction

## Background

Even in modern American society, lesbian, gay, and bisexual (LGB) individuals are still targets of discrimination at a systemic level, as evidenced by the legislation that seeks to target these individuals at all levels of government, ranging from the federal to municipal @hrc. As posited by Meyer, LGB individuals that have to face such discrimination and prejudice in society are subject to an increased risk of developing mental health problems due to the *minority stress* that they encounter in their daily lives @minority_stress. However, while this original meta-analysis specifically explored the disparities between the mental health outcomes of LGB individuals against heterosexual individuals, it did not necessarily account for compounding factors that could also influence stress, such as a LGB individuals who are also part of racial minority groups or comparing LGB individuals who are women as opposed to LGB individuals who are men. More recent research exploring these same phenomenon has been done in recent years to see how over time the mental health outcomes of LGB individuals compare to those of heterosexual individuals, while also trying to adjust for these other factors that account for how LGB individuals might also be part of other minority groups. One such study, utilizing data from the National Epidemiologic Survey of Alcohol and Related Conditions (NESARC) that was collected in 2005, found that LGB individuals were associated with a higher odds of having mental health disorders only if they were subject to other forms of discrimination as due to their other marginalized identities outside of just being a LGB individual @NESARC.

In this report, I seek to further expand upon the line of exploration of how different marginalized identities could together have an association with higher odds of having mental health disorders. I also seek to control for other factors that might influence differential treatment for individuals based on their societal contexts, such as accounting for the region in which people live.

## Dataset Description and Variables of Interest

```{r load-data}
#setwd("/Users/shirley/Downloads/ICPSR_37166/DS0001")
load("ICPSR_37166/DS0001/37166-0001-Data.rda")
load("ICPSR_37166/DS0003/37166-0003-Data.rda")
load("ICPSR_37166/DS0005/37166-0005-Data.rda")
load("ICPSR_37166/DS0007//37166-0007-Data.rda")

# use weights
# longitudinal data
# take difference and regress on that


# CHARACTERISTICS VARS
# w1sexminid, w2sexminid - broad categorization of sexuality (gay/lesbian, bi/pan, other (ace, anti-label, etc.))
# educ1 or educ2 (GEDUC1 has 4 options for education, GEDUC2 has 2 options for education)
#gurban, gurban_i (urbanicity, either imputed)
#gcenreg (census division into NE, Midwest, South, West)
# cohort variable looks at age (young, middle, and old)
# utilize survey 2 weights (w2) for longitudinal analysis
# w1_race for racial categories
# w1sex_gender for gender and sex combined variable
# gmilesaway2 (whether or not there is LGBT health center within 60 miles of respondent)
# w1poverty (whether or not individual is living in poverty (using 2017 thresholds))
# w1conversion (whether or not individual underwent therapy for sexual orientation change)
# w1conversionhc (whether or not individual's sex converesion was from healthcare provider)
# w1conversionrel (whether or not individual's sex converesion was from religious leader)

##### OUTCOMES
# w1socialwb, w1socialwb_i, w2socialwb, w2socialwb_i (social well being, use imputed values or not)
# w1kessler6, w1kessler6_i, w2kessler6, w2kessler6_i (mental disability, use imputed values or not)


# can just use the combined "socialwb" type scales for response variables

```

```{r data-exploration}

# set df equal to full data across both waves
df <- da37166.0007

# filter for only those participants who participated in both waves
full_df <- df %>%
  filter(WAVEPARTICIPATED == "(2) Waves 1 and 2")

# look at counts across race
unique(full_df$W1RACE)
full_df %>%
  group_by(W1RACE) %>%
  summarise(count = n())

# look at counts across census division
full_df %>%
  group_by(GCENDIV) %>%
  summarise(count = n())

# look at counts for gender
full_df %>%
  group_by(W1SEX_GENDER) %>%
  summarise(count = n())

# look at counts for outcome of interest: mental disability at w1
full_df %>%
  group_by(W1KESSLER6) %>%
  summarise(count = n())

# look at counts for outcome of interest: mental disability at w2
full_df %>%
  group_by(W2KESSLER6) %>%
  summarise(count = n())

# look at counts for potential outcome of interest: social well being at w1
full_df %>%
  group_by(W1SOCIALWB) %>%
  summarise(count = n())

# look at counts for potential outcome of interest: social well being at w2
full_df %>%
  group_by(W2SOCIALWB) %>%
  summarise(count = n())

# look at counts for broad sexuality grouping
full_df %>% 
  group_by(W2SEXMINID) %>%
  summarise(count = n())

# look at counts for specific sexuality grouping
full_df %>% 
  group_by(W2SEXUALID) %>%
  summarise(count = n())

# look at how many individuals are missing either w1 or w2 kessler data
full_df %>% 
  filter(is.na(W2KESSLER6) | is.na(W1KESSLER6)) %>%
  count()
# 29 observations missing value from both times for kessler rating

# filter to only get observations that have values at both time periods, and select only variables and covariates of interest
complete_full_df <- full_df %>%
  filter(!(is.na(W2KESSLER6) | is.na(W1KESSLER6))) %>%
  select(W2SEXMINID, GEDUC1, GURBAN, GCENREG, COHORT, W2WEIGHT, W1RACE, W1SEX_GENDER, W1KESSLER6, W2KESSLER6, W1SEX_GENDER, W1POVERTY) %>%
  drop_na()

missing_num <- pull(count(full_df)) - pull(count(complete_full_df))

```

The dataset that was used for this report consisted of survey data from Wave 1 and Wave 2 of the Generations study that was conducted from 2017 through 2019. This study sought to explore a variety of outcomes, ranging from personal and social wellbeing to health outcomes, for members of the LGB population in the US. With context to the aims of my investigation, I was mainly interested in demographic variables that described the background characteristics of the surveyed individuals and how those were associated with mental health outcomes. The variables of interest are delineated below.

* Kessler-6 Score - the Kessler-6 is a questionnaire that asks participants how often they have felt “nervous,” “hopeless,” “restless or fidgety,” “so depressed that nothing could cheer you up,” “that everything was an effort,” and “worthless” in the past 30 days, and is used as a clinical screening tool for assessing if an individual is suffering from Major Depressive Disorder (MDD) @kessler_2003. This score was the outcome of interest in assessing the mental health outcomes of respondents.
* Sexuality - this variable is a categorical variables that categorizes respondents as either "gay/lesbian", "bisexual", or "other", depending on the write-in responses they provided for how they label their sexuality. 
* Education - this variable is a categorical variables that provides information on a respondent's level of education as "high school or less", "some college", "college completed", or "more than college completed."
* Urbanicity - this variable encodes whether a respondent lives in a locale that is considered urban, as defined in the Generations study technical notes, or if a respondent lives in a locale that is not considered urban.
* Geographical Census Region - encodes which geographical census region a respondent is from, and the census regions are defined as
  - Northeast: Connecticut, Maine, Massachusetts, New Hampshire, New Jersey, New York, Pennsylvania, Rhode Island, Vermont
  - Midwest: Indiana, Illinois, Michigan, Ohio, Wisconsin, Iowa, Kansas, Minnesota, Missouri, Nebraska, North Dakota, South Dakota
  - South: Delaware, District of Columbia, Florida, Georgia, Maryland, North Carolina, South Carolina, Virginia, West Virginia, Alabama, Kentucky, Mississippi, Tennessee, Arkansas, Louisiana, Oklahoma, Texas
  - West: Arizona, Colorado, Idaho, New Mexico, Montana, Utah, Nevada, Wyoming, Alaska, California, Hawaii, Oregon, Washington
* Cohort - variable that characterizes whether a respondent belongs to the "young" (16-27), "middle" (32-43), and "old" (50-61) age range.
* Race - variable that characterizes the self-reported race of a respondent as being one of: White, Hispanic/Latino, Asian, Multiracial, Middle Eastern, American Indian, Black/African American, or Native Hawaiian/Pacific Islander.
* Sex and Gender - variable that combines sex and gender information to classify respondents as one of: women, non-transgender; men, non- transgender; genderqueer/non- binary (GQNB), female; GQNB, male.
* Poverty - variable that characterizes whether a respondent lives in poverty or not, where living in poverty is defined as living below 100% Federal Poverty Line (FPL) according to the FPL calculated in 2017.

For the final dataset, I selected the above variables from the original dataset that contained 894 observations for participants who participated in both Wave 1 and Wave 2 and 929 variables, of which majority were survey questions that were used to compute measures for outcomes of interest (such as the Kessler-6 Score). I removed all observations that had missing data for any of the variables of interest, which resulted in dropping 57 observations and a final dataset containing 837 observations.


## Objective

The main objective of this report is to explore the associations between various demographic characteristics of a LGB individual and their mental health outcomes. Specifically, in the context of this study, since participants were measured at Wave 1 and Wave 2, I want to examine how, if at all, a participant's mental health outcome changed over the course of the year and what associations this change might have with the background characteristics and an individual. This would allow us to gain insight into how other societal factors and minority statuses that LGB individuals hold might impact their mental health outcomes.

The secondary objective of this report is to explore if LGB individuals across different races had varying mental health outcomes over the course of this study. Thus, I aim to explore whether or not the direction and magnitude of an association with a LGB individual being from a particular racial category with mental health outcomes differs across the racial categories. This question is of particular interest to me as race is one aspect of an individual's identity that is theorized as leading to *minority stress* in an individual's life, so I wish to examine the intersection of these stressors in context with the stressors that are commonly felt amongst LGB individuals.

## Exploratory Data Analysis

```{r eda-plots, fig.width = 8}
complete_df <- complete_full_df %>%
  mutate(kessler_diff = W2KESSLER6 - W1KESSLER6,
         W1RACE = str_sub(W1RACE, 5, -1),
         W1SEX_GENDER = str_sub(W1SEX_GENDER, 5, -1),
         W1POVERTY = str_sub(W1POVERTY, 5, -1),
         GCENREG = str_sub(GCENREG, 5, -1),
         GURBAN = str_sub(GURBAN, 5, -1),
         GEDUC1 = str_sub(GEDUC1, 5, -1),
         W2SEXMINID = str_sub(W2SEXMINID, 5, -1),
         COHORT = str_sub(COHORT, 5, -1))

diff_distribution <- complete_df %>%
  ggplot(mapping = aes(x = kessler_diff)) +
  geom_histogram() +
  labs(title = "Distribution in Change of Kessler-6 Scores Among Participants",
       x = "Difference of Score\n (Wave 2 - Wave 1)",
       y = "Count") +
  theme_bw()

race_diff <- complete_df %>%
  ggplot(mapping = aes(x = W1RACE, y = kessler_diff)) +
  geom_boxplot() +
  labs(title = "Change of Kessler-6 Scores\n Across Race",
       y = "Difference of Score\n (Wave 2 - Wave 1)",
       x = "Race") +
  coord_flip() +
  theme_bw()

income_diff <- complete_df %>%
  ggplot(mapping = aes(x = W1POVERTY, y = kessler_diff)) +
  geom_boxplot() +
  labs(title = "Change of Kessler-6 Scores\n Across Poverty Status",
       y = "Difference of Score\n (Wave 2 - Wave 1)",
       x = "Poverty Status") +
  coord_flip() +
  theme_bw()

geo_diff <- complete_df %>%
  ggplot(mapping = aes(x = GCENREG, y = kessler_diff)) +
  geom_boxplot() +
  labs(title = "Change of Kessler-6 Scores\n by Geographical Region",
       y = "Difference of Score\n (Wave 2 - Wave 1)",
       x = "Geographical Region") +
  coord_flip() +
  theme_bw()

age_diff <- complete_df %>%
  ggplot(mapping = aes(x = COHORT, y = kessler_diff)) +
  geom_boxplot() +
  labs(title = "Change of Kessler-6 Scores\n by Age Cohort",
       y = "Difference of Score\n (Wave 2 - Wave 1)",
       x = "Age Cohort") +
  coord_flip() +
  theme_bw()

diff_distribution + plot_annotation(caption = "Figure 1: Distribution in change of Kessler-6 Scores from Wave 1 survey to Wave 2 survey. \n As seen above, the distribution of difference in score appears to be approximately normal.")

income_age <- (income_diff + age_diff)
race_geo <- race_diff + geo_diff
income_age +
  plot_annotation(caption = "Figure 2: Distribution of changes in Kessler-6 scores from Wave 1 survey to Wave 2 survey amongst participants \n with varying demographic characeristics of poverty status and age cohort.",
                  tag_levels = "A")

race_geo +
  plot_annotation(caption = "Figure 3: Distribution of changes in Kessler-6 scores from Wave 1 survey to Wave 2 survey amongst participants \n with varying demographic characeristics of racial identity and geographic region of residence.",
                  tag_levels = "A")
```

From Figure 1 above, we can observe that the distribution of difference in Kessler-6 score is approximately normal amongst the sample of participants that participated in both waves of the Generations survey.

From Figure 2A, we can see that the median change in Kessler-6 Score for individuals who live below the FPL appears to be lower than the median change in Kessler-6 Score for individuals who live above the FPL. Thus, we might want to consider poverty status as a covariate in our model to see whether there is a statistically significant association between poverty status and change in Kessler-6 Score.

From Figure 2B, we can see that the median change in Kessler-6 Score for individuals across all of the age cohorts appears to be relatively the same. However, we would need to include age cohort as a covariate in our model to see whether there is a statistically significant association between age cohort and change in Kessler-6 Score.

From Figure 3A, we can see that the median change in Kessler-6 Score seems to be different for different racial subgroups of the survey sample. From the plot, it appears that Multiracial, White, Hispanic/Latino, Black/African American, and Asian individuals have approximately the same median change in Kessler-6 Score. However, it appears that Native Hawaiian/Pacific Islander and Middle Eastern individuals have a lower median Kessler-6 Score than individuals in all of the other racial categories. Due to the apparent differences in the distributions for change in Kessler-6 Score across the different racial groups, we might want to consider race as a covariate in our model to see whether there is a statistically significant association between race and change in Kessler-6 Score.

From Figure 3B, we can see that the median change in Kessler-6 Score seems to be roughly the same across all of the various geographic census regions. However, while all of the regions seem to have fairly symmetric distributions, the South seems to be skewed left, perhaps implying that more individuals in the South region had a positive change in Kessler-6 score. Given that even though the median is roughly the same, but the distributions vary, it might be useful to include geogrphic region as a covariate in our model to assess whether it has a statistically significant association with change in Kessler-6 Score.

# Methodology

## Model Selection

For modeling the relationship between the covariates of interest and the difference in Kessler-6 outcomes between the Wave 1 survey and Wave 2 survey, I decided to utilize a mixed effects linear regression model. The rationale behind this modeling approach is that while all of the covariates of interest are categorical variables, some have only two factors, such as poverty status, whereas others have many more, such as race. Furthermore, the variables that have many more covariates, such as race, seem to have imbalanced counts of different categories, which is where having random intercepts by race could be useful in modeling the association between racial category and change in Kessler-6 Score.

## Model Specification

The model that I ran is specified as follows, where $i$ indexes each individual respondent, and $j$ indexes the racial group to which the $i$-th individual belongs:
\begin{multline*}
Y_i = \beta_0 + \beta_1(\text{Sexuality}_i = \text{Bisexual}) + \beta_2(\text{Sexuality}_i = \text{Other Sexual Minority}) + \beta_3(\text{Education}_i = \text{Some college}) \\
+ \beta_4(\text{Education}_i = \text{College}) + \beta_5(\text{Education}_i = \text{More than college}) + \beta_6(\text{Urbanicity}_i = \text{Urban}) \\
+ \beta_7(\text{Region}_i = \text{Midwest}) + \beta_8(\text{Region}_i = \text{South}) + \beta_9(\text{Region}_i = \text{West})  + \beta_{10}(\text{Age Cohort}_i = \text{Middle}) \\
+ \beta_{11}(\text{Age Cohort}_i = \text{Older}) + \beta_{12}(\text{Sex, Gender}_i = \text{Men, non-transgender}) \\
+ \beta_{13}(\text{Sex, Gender}_i = \text{Genderqueer/Non-Binary, Female}) + \beta_{14}(\text{Sex, Gender}_i = \text{Genderqueer/Non-Binary, Male}) \\
+ \beta_{15}(\text{Poverty Status}_i = \text{Below FPL}) + b_{0j} + \epsilon_{ij}
\end{multline*}

\begin{align*}
\text{where } &\beta_{0i} \sim N(0, \sigma_0) \perp \epsilon_{ij} \sim N(0, \sigma)
\end{align*}

with the **brms** default priors set on all parameters as follows:

\begin{align*}
\sigma_0, \sigma, \beta_0 \stackrel{iid}{\sim} \text{half-Student-t}(3)
\end{align*}

as well as flat prior specified for all of the $\beta_k$ coefficients, where $k = 1, \ldots, 15$. The justification for these priors is that they are weakly informative and lead to improved convergence and sampling efficiency for the posterior @gelman_2006. For running the model, I utilized the **brms** package and ran it on `R` version 4.0.3. For the model, I sampled four chains of one-thousand iterations to obtain the posterior samples for the parameters.


## Model Diagnostics

I plotted trace plots, density plots, and ACF plots for all of the parameters for all four chains of the model to assess the validity of the model. These can be seen in the **Appendix: Model Validation**.

# Results
```{r model}
#  m1 <- lmer(kessler_diff ~ 1 + W2SEXMINID + GEDUC1 + GURBAN + GCENREG + COHORT + (1 | W1RACE) + W1SEX_GENDER + W1POVERTY, data = complete_df,
#            weights = W2WEIGHT)
# 
#  m2 <- lmer(kessler_diff ~ 1 + W2SEXMINID + GEDUC1 + GURBAN + GCENREG + COHORT + (1 | W1RACE) + W1SEX_GENDER + W1POVERTY, data = complete_df)

m3 <- brm(kessler_diff ~ 1 + W2SEXMINID + GEDUC1 + GURBAN + GCENREG + COHORT + (1 | W1RACE) + W1SEX_GENDER + W1POVERTY, data = complete_df)

# summary(m1)
# summary(m2)
# summary(m3)

```

```{r results, results=TRUE}
posterior_draws <- as.data.frame(m3)
colnames(posterior_draws) <- c("Intercept", "Bisexual", "Other Sexual Minority",
                               "Some College", "College", "More than College",
                               "Urban",
                               "Midwest", "South", "West",
                               "Middle Age Cohort", "Older Age Cohort",
                               "Men, Non-transgender", "Genderqueer Non-binary, Female", "Genderqueer Non-binary, Male",
                               "Below FPL",
                               "Sigma for Race Intercept",
                               "Sigma",
                               "Asian",
                               "Black/African American",
                               "Hispanic/Latino",
                               "Middle Eastern",
                               "Native Hawaiian/Pacific Islander",
                               "White",
                               "American Indian",
                               "Multiracial"
                               )
posterior_draws <- posterior_draws[,c("Intercept", 
                                      "Bisexual", "Other Sexual Minority", #row 2-3
                                      "Some College", "College", "More than College", #rows 4-6
                                      "Urban", #row 7
                                      "Midwest", "South", "West", # rows 8-10
                                      "Middle Age Cohort", "Older Age Cohort", #rows 11-12
                                      "Men, Non-transgender", "Genderqueer Non-binary, Female", "Genderqueer Non-binary, Male", # rows 13-15
                                      "Below FPL", # row 16
                                      "Sigma for Race Intercept", #row 17 - 25
                                      "Asian",
                                      "Black/African American",
                                      "Hispanic/Latino",
                                      "Middle Eastern",
                                      "Native Hawaiian/Pacific Islander",
                                      "White",
                                      "American Indian",
                                      "Multiracial",
                                      "Sigma") ]
est <- round(unlist(map_dbl(posterior_draws, ~unlist(mean(.x)))),3)
attr(est, which = "names") <- NULL
est <- est[1:length(est) - 1]
q1 <- round(unlist(map_dbl(posterior_draws, ~ unlist(quantile(.x, 0.025)))),3)
attr(q1, which = "names") <- NULL
q1 <- q1[1:length(q1) - 1]
q2 <- round(unlist(map_dbl(posterior_draws, ~ unlist(quantile(.x, 0.975)))),3)
attr(q2, which = "names") <- NULL
q2 <- q2[1:length(q2) - 1]
data.frame(Variable = colnames(posterior_draws)[1:length(est)],
           Parameter_Estimate = est,
           Quantile1 = q1,
           Quantile2 = q2
           ) %>%
  kbl(caption = "Summary of Parameter Posterior Distributions", col.names = c("Variables", "Posterior Mean", "2.5th Percentile", "97.5th Percentile"), booktabs = T) %>%
  group_rows("Sexual Identity Coefficients", 2, 3) %>%
  group_rows("Education Coefficients", 4, 6) %>%
  group_rows("Urbanicity Coefficients", 7, 7) %>%
  group_rows("Geographical Region Coefficients", 8, 10) %>%
  group_rows("Age Cohort Coefficients", 11, 12) %>%
  group_rows("Sex and Gender Coefficients", 13, 15) %>%
  group_rows("Poverty Status Coefficients", 16, 16) %>%
  group_rows("Random Intercepts by Race", 17, 25) %>%
  kable_styling(latex_options = "HOLD_position")
```


```{r compare-race-levels, results=TRUE}
race_comp <- spread_draws(m3, r_W1RACE[W1RACE,]) %>%
  mutate(W1RACE = case_when(
    W1RACE == "Asian" ~ "Asian",
    W1RACE == "Black/African.American" ~ "Black/African American",
    W1RACE == "Hispanic/Latino" ~ "Hispanic/Latino",
    W1RACE == "Middle.Eastern" ~ "Middle Eastern",
    W1RACE == "Native.Hawaiian/Pacific.Islander" ~ "Native Hawaiian/Pacific Islander",
    W1RACE == "White" ~ "White",
    W1RACE == "American.Indian"  ~ "American Indian",
    W1RACE == "Multirace" ~ "Multiracial"
  )) %>%
  compare_levels(r_W1RACE, by = W1RACE) %>%
  ungroup() %>%
  mutate(W1RACE = reorder(W1RACE, r_W1RACE)) %>%
  mutate(`Conditional Mean` = r_W1RACE) 

comparison_intervals <- race_comp %>%
  group_by(W1RACE) %>%
  median_qi(.width = c(0.66, 0.95)) %>%
  rowwise() %>%
  mutate(Significant = ifelse(between(0, `Conditional Mean.lower`, `Conditional Mean.upper`), "No", "Yes")) 

comparison_intervals[1:28,] %>%
  select(W1RACE, `Conditional Mean.lower`, `Conditional Mean`, `Conditional Mean.upper`) %>%
  kbl(caption = "Summary of Conditional Means of Comparisons of Race Intercepts (66th Percentile Intervals)", col.names = c("Race Comparison", "Lower Quantile", "Conditional Mean", "Upper Quantile"), booktabs = T, digits = 3) 

comparison_intervals[29:56,] %>%
  select(W1RACE, `Conditional Mean.lower`, `Conditional Mean`, `Conditional Mean.upper`) %>%
  kbl(caption = "Summary of Conditional Means of Comparisons of Race Intercepts (95th Percentile Intervals)", col.names = c("Race Comparison", "Lower Quantile", "Conditional Mean", "Upper Quantile"), booktabs = T, digits = 3)

```

From the results provided above in Table 1, the only statistically significant association found within the model is that of the association between an LGB individual being located in the South as opposed to the North. In particular, the model results indicate that, holding all other covariates constant, a LGB individual located in the South is expected to have an difference in Kessler-6 Score that is 0.941 units greater than a LGB individual located in the North.

With regards to the differences amongst racial groups, none of the mean differences between the random intercepts by race, conditional on all other covariates being constant, were found to be statistically significant when examining either 66% posterior intervals of 95% posterior intervals, as seen in Table 2 and Table 3 above.

# Discussion

## Investigative Conclusions
From the model results, with regards to the general question of whether mental health outcomes differ across LGB individuals from various different demographic background, it appears that the only significant association with difference in outcome is between those LGB individuals located in the South as opposed to the North. This finding struck me as somewhat surprising given that typically Northern states tend to have better legal protections in place for LGB people and more positive societal attitudes towards LGB people than Southern states (@hrc).

With regards to the secondary question of interest of examining whether there are any differences amongst the racial groups, it appears that there are no statistially significant differences in the magnitude of the association between race and mental health outcomes across all of the racial groups. This finding also struck me as surprising, as it seems counter-intuitive to what has been suggested in the literature elsewhere that other demographic characteristics, such as race, might have differential associations with mental health outcomes within the population LGB people in the U.S. (@NESARC).

## Limitations and Future Work

One major limitation of this study is that the modeling approach used in this paper does not account for survey weights associated with each individual that was sampled in the survey. Within the survey, each respondent was assigned a survey weight in order to correct bias that would ensue from the sample due to the fact that the sample was not a representative sample of the LGB population at large in the U.S. In particular, this sample oversampled White LGB individuals and had very few observations for LGB people from other racial groups such as Native Hawaiian/Pacific Islander, Asian, and Middle Eastern. Thus, it is possible that not accounting for the survey weights in the modeling approach has led to biased results in the model findings. In future work, researchers could try and incorporate survey weights into the modelling approach, as perhaps that would remove sources of bias when sampling from the posterior distributions of the model parameters. Such approaches might reference work done in @si_2017 to inform the modeling approach. 

Another way to approach the modeling that I had considered to alleviate the issue of survey weights was utilizing a frequentist linear mixed effects model that could account for survey weights. However, it is difficult to quantify uncertainty for parameter estimates using frequentist linear mixed effects models, which could lead to results that are not readily interpretable in the context of the research objectives.

Another limitation of this paper is that I utilized a linear model that can technically have non-integer outcomes for the difference in Kessler-6 score even though the Kessler-6 scale is technically only an integer-value scale and thus can only have integer-value outcomes for the difference in score. Thus, another idea for future work could be to instead model the outcome as a binary categorical response of whether or not the change in score was positive or negative. However, this would lead to loss of information on the magnitude of the change that is associated with the covariates.

One other potential limitation of this analysis is that I sought to analyze differences in Kessler-6 outcomes between Wave 1 and Wave 2 of the Generations study. Thus, it is difficult to ascertain if there are necessarily differences in the baseline mental health status of individuals from various geographic regions or racial groups, as this analysis instead looks at associations amongst demographic characteristics and changes in mental health outcomes as opposed to just looking at the association between demographic characteristics and baseline mental health status. For example, my analysis found the only statistically significant association to be that which is present between an individual being from the South as opposed to the Northeast, and in particular this association seemed to indicate that LGB individuals in the South were associated with a more positive change in Kessler-6 score as opposed to individuals from the Northeast. However, it could be the case that the baseline scores of individuals in the South were lower than those of individuals from the Northeast, so then even with individuals from the South having a more positive difference, they might still have poorer overall mental health outcomes than their counterparts in the Northeast. Thus, future work in this area could instead seek to analyze associations between final Kessler-6 scores and demographic characterisitics to see in general how mental health outcomes themselves, and not differences in mental health outcomes over the course of a year, are associated with various demographic characterisitics of LGB individuals.

## Summary
Overall, the findings of this paper are that the only covariate that seems to be have a statistically significant association with change in Kessler-6 Score is that of whether a LGB individual is from the South as opposed to being from the Northeast. In particular, this association is in the positive direction, which seems to indicate that perhaps LGB individuals in the South had improved mental health outcomes over the course of the Generations survey as opposed to LGB individuals from the Northeast. The other question of major interest was whether there were any differential impacts of race on mental health outcomes of LGB individuals, and from the modeling results in this paper, there do not appear to be any statistically significant differences in how race impacts mental health outcomes across the various racial groups that were present in the survey sample. Thus, we cannot make any conclusive evidence of an association with belonging to different racial groups having an impact on mental health outcomes.

\newpage
# Appendix

## Model Validation

```{r model-validation-plots}
trace_data_names <- unique(mcmc_trace_data(m3)$parameter)
trace_data <- mcmc_trace_data(m3) %>%
  filter(parameter %in% trace_data_names[1:26]) %>%
  mutate(parameter = case_when(
    parameter == trace_data_names[[1]] ~ "Intercept",
    parameter == trace_data_names[[2]] ~ "Sexual Identity - Lesbian/Gay",
    parameter == trace_data_names[[3]] ~ "Sexual Identity - Other Sexual Minority",
    parameter == trace_data_names[[4]] ~ "Education - Less than High School",
    parameter == trace_data_names[[5]] ~ "Education - More than college",
    parameter == trace_data_names[[6]] ~ "Education - Some college",
    parameter == trace_data_names[[7]] ~ "Urbanicity - Urban",
    parameter == trace_data_names[[8]] ~ "Region - Northeast",
    parameter == trace_data_names[[9]] ~ "Region - South",
    parameter == trace_data_names[[10]] ~ "Region - West",
    parameter == trace_data_names[[11]] ~ "Cohort - Older",
    parameter == trace_data_names[[12]] ~ "Cohort - Younger",
    parameter == trace_data_names[[13]] ~ "Sex,Gender - Queer/NB Male",
    parameter == trace_data_names[[14]] ~ "Sex,Gender - Cisgender Male",
    parameter == trace_data_names[[15]] ~ "Sex,Gender - Cisgender Female",
    parameter == trace_data_names[[16]] ~ "Poverty - Below FPL",
    parameter == trace_data_names[[17]] ~ "Race Intercepts Sigma",
    parameter == trace_data_names[[18]] ~ "Sigma",
    parameter == trace_data_names[[19]] ~ "Race - American Indian",
    parameter == trace_data_names[[20]] ~ "Race - Asian",
    parameter == trace_data_names[[21]] ~ "Race - Black/African American",
    parameter == trace_data_names[[22]] ~ "Race - Hispanic/Latino",
    parameter == trace_data_names[[23]] ~ "Race - Middle Eastern",
    parameter == trace_data_names[[24]] ~ "Race - Multiracial",
    parameter == trace_data_names[[25]] ~ "Race - Native Hawaiian/Pacific Islander",
    parameter == trace_data_names[[26]] ~ "Race - White"))

trace_plot <- trace_data %>%
  ggplot(mapping = aes(x = iteration, y = value, color = chain)) +
 # scale_color_manual(values = c("red", "blue", "green", "pink")) +
  geom_line(alpha = 0.5) +
  facet_wrap(~ parameter, scales = "free_y")  +
  theme_bw(base_size = 6) +
  labs(x = "Iteration", y = "Sampled Value")

density_plot <- trace_data %>%
  ggplot(mapping = aes(x = value, color = chain)) +
  geom_density() +
#  scale_color_manual(values = c("red", "blue")) +
  theme_bw(base_size = 6) +
  labs(x = "Sampled Values") +
  facet_wrap( ~ parameter, scales = "free")
  
pp_check_hist <- pp_check(m3, plotfun = "hist", nreps = 5, binwidth = 1) + 
  xlab("Kessler-6 Difference") 

acf_data <- mcmc_acf_bar(m3)$data
acf_plot_1 <- acf_data %>% 
  filter(Parameter %in% trace_data_names[1:5]) %>%
  mutate(Parameter = case_when(
  Parameter == trace_data_names[[1]] ~ "Intercept",
    Parameter == trace_data_names[[2]] ~ "Sexual Identity - Lesbian/Gay",
    Parameter == trace_data_names[[3]] ~ "Sexual Identity - Other Sexual Minority",
    Parameter == trace_data_names[[4]] ~ "Education - Less than High School",
    Parameter == trace_data_names[[5]] ~ "Education - More than college")) %>%
  ggplot(mapping = aes(x = Lag, y = AC)) +
  geom_bar(stat = "identity", color = "red", fill = "red", alpha = 0.5) +
  facet_grid(Chain ~ Parameter) +
  labs(x = "Lag", y = "Autocorrelation") +
  theme_bw(base_size = 6)

acf_plot_2 <- acf_data %>% 
  filter(Parameter %in% trace_data_names[6:10]) %>%
  mutate(Parameter = case_when(
    Parameter == trace_data_names[[6]] ~ "Education - Some college",
    Parameter == trace_data_names[[7]] ~ "Urbanicity - Urban",
    Parameter == trace_data_names[[8]] ~ "Region - Northeast",
    Parameter == trace_data_names[[9]] ~ "Region - South",
    Parameter == trace_data_names[[10]] ~ "Region - West")) %>%
  ggplot(mapping = aes(x = Lag, y = AC)) +
  geom_bar(stat = "identity", color = "red", fill = "red", alpha = 0.5) +
  facet_grid(Chain ~ Parameter) +
  labs(x = "Lag", y = "Autocorrelation") +
  theme_bw(base_size = 6)

acf_plot_3 <- acf_data %>% 
  filter(Parameter %in% trace_data_names[11:15]) %>%
  mutate(Parameter = case_when(
    Parameter == trace_data_names[[11]] ~ "Cohort - Older",
    Parameter == trace_data_names[[12]] ~ "Cohort - Younger",
    Parameter == trace_data_names[[13]] ~ "Sex,Gender - Queer/NB Male",
    Parameter == trace_data_names[[14]] ~ "Sex,Gender - Cisgender Male",
    Parameter == trace_data_names[[15]] ~ "Sex,Gender - Cisgender Female")) %>%
  ggplot(mapping = aes(x = Lag, y = AC)) +
  geom_bar(stat = "identity", color = "red", fill = "red", alpha = 0.5) +
  facet_grid(Chain ~ Parameter) +
  labs(x = "Lag", y = "Autocorrelation") +
  theme_bw(base_size = 6)

acf_plot_4 <- acf_data %>% 
  filter(Parameter %in% trace_data_names[16:20]) %>%
  mutate(Parameter = case_when(
    Parameter == trace_data_names[[16]] ~ "Poverty - Below FPL",
    Parameter == trace_data_names[[17]] ~ "Race Intercepts Sigma",
    Parameter == trace_data_names[[18]] ~ "Sigma",
    Parameter == trace_data_names[[19]] ~ "Race - American Indian",
    Parameter == trace_data_names[[20]] ~ "Race - Asian"
)) %>%
  ggplot(mapping = aes(x = Lag, y = AC)) +
  geom_bar(stat = "identity", color = "red", fill = "red", alpha = 0.5) +
  facet_grid(Chain ~ Parameter) +
  labs(x = "Lag", y = "Autocorrelation") +
  theme_bw(base_size = 6)

acf_plot_5 <- acf_data %>% 
  filter(Parameter %in% trace_data_names[21:26]) %>%
  mutate(Parameter = case_when(
    Parameter == trace_data_names[[21]] ~ "Race - Black/African American",
    Parameter == trace_data_names[[22]] ~ "Race - Hispanic/Latino",
    Parameter == trace_data_names[[23]] ~ "Race - Middle Eastern",
    Parameter == trace_data_names[[24]] ~ "Race - Multiracial",
    Parameter == trace_data_names[[25]] ~ "Race - Native Hawaiian/Pacific Islander",
    Parameter == trace_data_names[[26]] ~ "Race - White")) %>%
  ggplot(mapping = aes(x = Lag, y = AC)) +
  geom_bar(stat = "identity", color = "red", fill = "red", alpha = 0.5) +
  facet_grid(Chain ~ Parameter) +
  labs(x = "Lag", y = "Autocorrelation") +
  theme_bw(base_size = 6)
```
### Trace Plots

In order to assess the validity of the model, I plotted trace plots for all four chains that were run for the model. As shown below, the trace plots indeed appear to converge.
```{r trace-plots, fig.align='center'}
trace_plot +
  plot_annotation(caption = "Figure A-1: Trace Plots for all parameters.")
```


### Density Plots

In order to assess the validity of the model, I plotted density plots for the potsterior distributions of all the parameters for all four chains that were run for the model. As shown below, the density plots for the coefficient terms appear to be approximately normal, and the trace plots for the standard deviation of the race random intercepts as well as the standard deviation of the residuals both appear to be approximately half-Student-t distributions, as expected. Thus, the posterior densitites seem to appear as we would expect them to appear.
```{r density-plots, fig.align='center'}
density_plot  +
  plot_annotation(caption = "Figure A-2: Density Plots for all parameters.")
```


### ACF Plots

I plotted ACF plots to check the correlation between samples taken from subsequent iterations of the model to assess whether the posterior samples sufficiently explored the posterior distribution space. As Figures A-3 through A-7 below show, the ACF is fairly low for every 20 iterations, and thus it appears that posterior space was sufficiently explored.
```{r acf-plots, fig.align='center'}
acf_plot_1 +
  plot_annotation(caption = "Figure A-3: ACF Plots for parameters.")
acf_plot_2 +
  plot_annotation(caption = "Figure A-4: ACF Plots for parameters.")
acf_plot_3 +
  plot_annotation(caption = "Figure A-5: ACF Plots for parameters.")
acf_plot_4 +
  plot_annotation(caption = "Figure A-6: ACF Plots for parameters.")
acf_plot_5 +
  plot_annotation(caption = "Figure A-7: ACF Plots for parameters.")
```


## Plot of Conditional Mean of Posterior Comparisons for Race Intercepts

The plot below shows visually the results presented earlier in Tables 2 and 3. As seen earlier, none of the intervals seem to not contain zero, thus leading to us being unable to conclude if there are any differential impacts of race on mental health outcomes amongst LGB individuals.
```{r comparison-plots, results = TRUE}
race_comp %>%
  ggplot(aes(y = W1RACE, x = `Conditional Mean`)) +
  stat_halfeye() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  labs(x = "Conditional Mean Difference", y = "Race Estimated Effect Pairings") + 
  theme_bw() +
  plot_annotation(caption = "Figure A-8: Plot of conditional mean differences across random intercepts by race.")
```

\newpage

# References
